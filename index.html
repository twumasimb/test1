<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accessible Digital Art Gallery - Interactive & Inclusive</title>
    <meta name="description" content="An accessible, interactive digital art gallery with filtering, search, dark mode, and full keyboard/screen reader support.">
    <style>
        :root {
            --color-bg: #f8f9fa;
            --color-bg-dark: #181a1b;
            --color-text: #222;
            --color-text-dark: #f5f6fa;
            --color-primary: #0066cc;
            --color-accent: #e63946;
            --color-card: #fff;
            --color-card-dark: #23272b;
            --color-border: #e0e0e0;
            --color-border-dark: #2c3035;
            --focus-outline: #0066cc;
            --focus-outline-dark: #ffffff;
            --transition: 0.2s cubic-bezier(.4,0,.2,1);
        }
        html {
            box-sizing: border-box;
            font-size: 100%;
        }
        *, *::before, *::after {
            box-sizing: inherit;
        }
        body {
            background: var(--color-bg);
            color: var(--color-text);
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            min-height: 100vh;
            transition: background var(--transition), color var(--transition);
            line-height: 1.6;
        }
        body.dark-mode {
            background: var(--color-bg-dark);
            color: var(--color-text-dark);
        }
        header {
            background: var(--color-card);
            border-bottom: 1px solid var(--color-border);
            padding: 0.5rem 0;
            transition: background var(--transition), border-color var(--transition);
        }
        body.dark-mode header {
            background: var(--color-card-dark);
            border-bottom: 1px solid var(--color-border-dark);
        }
        nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            padding: 0 1rem;
        }
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 0.03em;
            color: var(--color-primary);
            text-decoration: none;
        }
        .controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .dark-toggle-btn {
            background: none;
            border: 2px solid var(--color-primary);
            color: var(--color-primary);
            border-radius: 2rem;
            padding: 0.4em 1.2em;
            font-size: 1rem;
            cursor: pointer;
            transition: background var(--transition), color var(--transition), border-color var(--transition);
        }
        .dark-toggle-btn[aria-pressed="true"] {
            background: var(--color-primary);
            color: #fff;
        }
        body.dark-mode .dark-toggle-btn {
            border-color: var(--color-text-dark);
            color: var(--color-text-dark);
        }
        body.dark-mode .dark-toggle-btn[aria-pressed="true"] {
            background: var(--color-text-dark);
            color: var(--color-bg-dark);
        }
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem 3rem 1rem;
        }
        h1 {
            font-size: 2.25rem;
            margin-bottom: 0.5em;
            margin-top: 0;
        }
        .gallery-filters {
            display: flex;
            flex-wrap: wrap;
            align-items: flex-end;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .filter-group label {
            font-weight: 600;
        }
        .filter-select, .search-input {
            padding: 0.5em 1em;
            border: 1px solid var(--color-border);
            border-radius: 0.25em;
            font-size: 1rem;
            background: var(--color-card);
            color: var(--color-text);
            transition: background var(--transition), color var(--transition), border-color var(--transition);
        }
        body.dark-mode .filter-select, 
        body.dark-mode .search-input {
            background: var(--color-card-dark);
            color: var(--color-text-dark);
            border-color: var(--color-border-dark);
        }
        .search-input {
            width: 220px;
        }
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 2rem;
        }
        .art-card {
            background: var(--color-card);
            border: 1px solid var(--color-border);
            border-radius: 0.5em;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.04);
            display: flex;
            flex-direction: column;
            transition: box-shadow var(--transition), border-color var(--transition), background var(--transition);
            position: relative;
        }
        body.dark-mode .art-card {
            background: var(--color-card-dark);
            border-color: var(--color-border-dark);
        }
        .art-thumb-btn {
            background: none;
            border: none;
            padding: 0;
            cursor: pointer;
            display: block;
            width: 100%;
            aspect-ratio: 4/3;
            position: relative;
            overflow: hidden;
        }
        .art-thumb-btn:focus {
            z-index: 2;
        }
        .art-thumb-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: transform var(--transition);
        }
        .art-card:hover .art-thumb-img,
        .art-thumb-btn:focus .art-thumb-img {
            transform: scale(1.04);
        }
        .art-info {
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .art-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0 0 0.25em 0;
        }
        .art-artist {
            font-size: 0.95rem;
            color: var(--color-primary);
            margin-bottom: 0.5em;
        }
        .art-meta {
            font-size: 0.9rem;
            color: #555;
        }
        body.dark-mode .art-meta {
            color: #aaa;
        }
        .art-card .hover-details {
            position: absolute;
            inset: 0;
            background: rgba(24,26,27,0.92);
            color: #fff;
            opacity: 0;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 1.5rem;
            font-size: 1.05rem;
            transition: opacity var(--transition);
            z-index: 3;
        }
        .art-card:hover .hover-details,
        .art-thumb-btn:focus ~ .hover-details {
            opacity: 1;
            pointer-events: auto;
        }
        /* For keyboard users, show hover details when focused */
        .art-thumb-btn:focus ~ .hover-details {
            opacity: 1;
            pointer-events: auto;
        }
        /* Modal Styles */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.75);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity var(--transition);
        }
        .modal.active {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background: var(--color-card);
            color: var(--color-text);
            border-radius: 0.5em;
            max-width: 96vw;
            max-height: 96vh;
            box-shadow: 0 8px 32px rgba(0,0,0,0.18);
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            outline: none;
            transition: background var(--transition), color var(--transition);
        }
        body.dark-mode .modal-content {
            background: var(--color-card-dark);
            color: var(--color-text-dark);
        }
        .modal-img {
            max-width: 80vw;
            max-height: 60vh;
            border-radius: 0.25em;
            margin: 2rem 2rem 1rem 2rem;
            object-fit: contain;
            background: #111;
        }
        .modal-info {
            padding: 0 2rem 2rem 2rem;
            text-align: center;
        }
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0.5em 0 0.25em 0;
        }
        .modal-artist {
            font-size: 1.1rem;
            color: var(--color-primary);
            margin-bottom: 0.5em;
        }
        .modal-meta {
            font-size: 1rem;
            color: #666;
        }
        body.dark-mode .modal-meta {
            color: #bbb;
        }
        .modal-desc {
            margin: 1em 0 0 0;
            font-size: 1.1rem;
        }
        .modal-close-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: var(--color-accent);
            color: #fff;
            border: none;
            border-radius: 2em;
            width: 2.5em;
            height: 2.5em;
            font-size: 1.25rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background var(--transition), color var(--transition);
        }
        .modal-close-btn:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
        }
        body.dark-mode .modal-close-btn {
            background: #fff;
            color: var(--color-accent);
        }
        /* Focus indicators for all interactive elements */
        button:focus, input:focus, select:focus, textarea:focus, a:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
        }
        body.dark-mode button:focus, 
        body.dark-mode input:focus, 
        body.dark-mode select:focus, 
        body.dark-mode textarea:focus, 
        body.dark-mode a:focus {
            outline: 3px solid var(--focus-outline-dark);
        }
        /* Responsive Design */
        @media (max-width: 800px) {
            .gallery-grid {
                gap: 1.25rem;
            }
            .modal-img {
                max-width: 95vw;
                max-height: 40vh;
                margin: 1rem 0 1rem 0;
            }
            .modal-info {
                padding: 0 1rem 1rem 1rem;
            }
        }
        @media (max-width: 600px) {
            h1 {
                font-size: 1.4rem;
            }
            .gallery-filters {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }
            .search-input {
                width: 100%;
            }
        }
        footer {
            background: var(--color-card);
            color: #666;
            text-align: center;
            padding: 1.25rem 1rem 1.5rem 1rem;
            font-size: 1rem;
            border-top: 1px solid var(--color-border);
            margin-top: 2rem;
            transition: background var(--transition), color var(--transition), border-color var(--transition);
        }
        body.dark-mode footer {
            background: var(--color-card-dark);
            color: #bbb;
            border-top: 1px solid var(--color-border-dark);
        }
        /* Hide visually but keep accessible for screen readers */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body>
    <header>
        <nav role="navigation" aria-label="Main navigation">
            <a href="#main-content" class="sr-only" id="skip-link">Skip to main content</a>
            <a href="#" class="logo" aria-label="Home - Digital Art Gallery">ArtGallery</a>
            <div class="controls">
                <button 
                    id="darkModeToggle" 
                    class="dark-toggle-btn" 
                    type="button" 
                    aria-pressed="false"
                    aria-label="Toggle dark mode"
                    onkeydown="handleInteraction(event)"
                    onclick="handleInteraction(event)">
                    <span aria-hidden="true" id="darkModeIcon">🌙</span>
                    <span id="darkModeLabel">Dark Mode</span>
                </button>
            </div>
        </nav>
    </header>
    <main id="main-content" tabindex="-1">
        <h1>Accessible Digital Art Gallery</h1>
        <section aria-label="Gallery filters and search" class="gallery-filters">
            <form id="filterForm" role="search" aria-label="Filter and search artworks" autocomplete="off" onsubmit="event.preventDefault();">
                <div class="filter-group">
                    <label for="categorySelect">Category:</label>
                    <select id="categorySelect" class="filter-select" name="category" aria-label="Filter by category">
                        <option value="all">All</option>
                        <option value="painting">Painting</option>
                        <option value="photography">Photography</option>
                        <option value="digital">Digital Art</option>
                        <option value="sculpture">Sculpture</option>
                        <option value="illustration">Illustration</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="searchInput">Search:</label>
                    <input 
                        type="search" 
                        id="searchInput" 
                        class="search-input" 
                        name="search" 
                        placeholder="Search by title or artist"
                        aria-label="Search artworks by title or artist"
                        autocomplete="off"
                    >
                </div>
            </form>
        </section>
        <section aria-label="Artworks gallery" id="gallerySection">
            <ul class="gallery-grid" id="galleryGrid" role="list">
                <!-- Gallery items rendered by JavaScript -->
            </ul>
            <div id="noResults" style="display:none; margin-top:2rem; text-align:center; font-size:1.2rem;">
                <span role="status" aria-live="polite">No artworks found. Try adjusting your filters or search.</span>
            </div>
        </section>
    </main>
    <!-- Modal for artwork details -->
    <div 
        id="artModal" 
        class="modal" 
        role="dialog" 
        aria-modal="true" 
        aria-labelledby="modalTitle" 
        aria-describedby="modalDesc"
        tabindex="-1"
        style="display:none;"
    >
        <div class="modal-content" id="modalContent" tabindex="0">
            <button 
                class="modal-close-btn" 
                id="modalCloseBtn" 
                type="button" 
                aria-label="Close artwork details"
                onkeydown="handleInteraction(event)"
                onclick="handleInteraction(event)">
                &times;
            </button>
            <img src="" alt="" id="modalImg" class="modal-img" />
            <div class="modal-info">
                <h2 class="modal-title" id="modalTitle"></h2>
                <div class="modal-artist" id="modalArtist"></div>
                <div class="modal-meta" id="modalMeta"></div>
                <div class="modal-desc" id="modalDesc"></div>
            </div>
        </div>
    </div>
    <footer>
        <p>
            &copy; 2024 ArtGallery. All rights reserved. | 
            <a href="#main-content">Back to top</a>
        </p>
        <p>
            <strong>Accessibility:</strong> This digital art gallery is designed to meet <abbr title="Web Content Accessibility Guidelines">WCAG</abbr> 2.1 AA standards for all users.
        </p>
    </footer>
    <script>
    // --- ARTWORK DATA (Sample Data for Demo) ---
    const artworks = [
        {
            id: 1,
            title: "Reflections",
            artist: "Ava Martinez",
            year: 2021,
            category: "photography",
            img: "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=600&q=80",
            alt: "A tranquil lake reflecting the mountains and sky at sunset",
            description: "A serene landscape photograph capturing the stillness of a mountain lake at dusk, with vivid reflections and calming tones."
        },
        {
            id: 2,
            title: "Vivid Dreams",
            artist: "Liam Chen",
            year: 2023,
            category: "digital",
            img: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=600&q=80",
            alt: "Colorful abstract digital artwork with swirling shapes",
            description: "A vibrant digital composition exploring the intersection of color, form, and emotion, inspired by dreams and imagination."
        },
        {
            id: 3,
            title: "The Thinker",
            artist: "Sofia Rossi",
            year: 2019,
            category: "sculpture",
            img: "https://images.unsplash.com/photo-1517694712202-14dd9538aa97?auto=format&fit=crop&w=600&q=80",
            alt: "Bronze sculpture of a person sitting in a thoughtful pose",
            description: "A modern interpretation of the classic 'Thinker' sculpture, emphasizing introspection and the human condition."
        },
        {
            id: 4,
            title: "Blooming City",
            artist: "Noah Kim",
            year: 2022,
            category: "painting",
            img: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=600&q=80",
            alt: "Colorful painting of a city skyline with blooming flowers",
            description: "A whimsical painting blending urban architecture with natural elements, symbolizing hope and renewal."
        },
        {
            id: 5,
            title: "Night Owl",
            artist: "Emily Carter",
            year: 2020,
            category: "illustration",
            img: "https://images.unsplash.com/photo-1502082553048-f009c37129b9?auto=format&fit=crop&w=600&q=80",
            alt: "Illustration of an owl perched on a branch under a starry night sky",
            description: "A detailed digital illustration celebrating nocturnal wildlife, with a focus on textures and the quiet of the night."
        },
        {
            id: 6,
            title: "Urban Geometry",
            artist: "Mateo García",
            year: 2021,
            category: "photography",
            img: "https://images.unsplash.com/photo-1465101178521-c1a9136a3a8b?auto=format&fit=crop&w=600&q=80",
            alt: "Black and white photograph of geometric patterns in city architecture",
            description: "A striking black and white photo exploring the shapes and patterns found in urban environments."
        },
        {
            id: 7,
            title: "Dancing Colors",
            artist: "Chloe Dubois",
            year: 2023,
            category: "painting",
            img: "https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?auto=format&fit=crop&w=600&q=80",
            alt: "Abstract painting with dynamic brushstrokes and bright colors",
            description: "An energetic abstract painting that evokes movement and rhythm through bold color choices and expressive brushwork."
        },
        {
            id: 8,
            title: "Digital Forest",
            artist: "Lucas Müller",
            year: 2022,
            category: "digital",
            img: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=600&q=80",
            alt: "Digital artwork of a surreal forest with glowing trees",
            description: "A digital landscape blending reality and fantasy, with illuminated trees creating an ethereal forest scene."
        },
        {
            id: 9,
            title: "Hands of Time",
            artist: "Olivia Smith",
            year: 2018,
            category: "sculpture",
            img: "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=600&q=80",
            alt: "Stone sculpture of interlocking hands forming a clock face",
            description: "A symbolic sculpture representing the passage of time and human connection."
        },
        {
            id: 10,
            title: "Starlit Stories",
            artist: "Isabella Lee",
            year: 2021,
            category: "illustration",
            img: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=600&q=80",
            alt: "Illustration of a child reading under a starlit sky",
            description: "A heartwarming illustration capturing the magic of storytelling beneath the stars."
        }
    ];

    // --- CATEGORY MAPPING FOR DISPLAY ---
    const categoryLabels = {
        painting: "Painting",
        photography: "Photography",
        digital: "Digital Art",
        sculpture: "Sculpture",
        illustration: "Illustration"
    };

    // --- STATE ---
    let currentCategory = 'all';
    let currentSearch = '';
    let filteredArtworks = artworks;
    let lastFocusedElement = null;
    let darkMode = false;

    // --- DOM ELEMENTS ---
    const galleryGrid = document.getElementById('galleryGrid');
    const categorySelect = document.getElementById('categorySelect');
    const searchInput = document.getElementById('searchInput');
    const noResults = document.getElementById('noResults');
    const artModal = document.getElementById('artModal');
    const modalContent = document.getElementById('modalContent');
    const modalImg = document.getElementById('modalImg');
    const modalTitle = document.getElementById('modalTitle');
    const modalArtist = document.getElementById('modalArtist');
    const modalMeta = document.getElementById('modalMeta');
    const modalDesc = document.getElementById('modalDesc');
    const modalCloseBtn = document.getElementById('modalCloseBtn');
    const darkModeToggle = document.getElementById('darkModeToggle');
    const darkModeIcon = document.getElementById('darkModeIcon');
    const darkModeLabel = document.getElementById('darkModeLabel');

    // --- ACCESSIBLE KEYBOARD/MOUSE HANDLER ---
    function handleInteraction(event) {
        // Ensures all interactive elements are accessible via keyboard and mouse
        if (
            event.type === 'click' ||
            (event.type === 'keydown' && (event.key === 'Enter' || event.key === ' '))
        ) {
            // Identify the triggering element
            const target = event.currentTarget;
            // Dark mode toggle
            if (target === darkModeToggle) {
                event.preventDefault();
                toggleDarkMode();
            }
            // Modal close button
            if (target === modalCloseBtn) {
                event.preventDefault();
                closeModal();
            }
        }
    }

    // --- FILTER AND SEARCH LOGIC ---
    function filterArtworks() {
        let results = artworks;
        if (currentCategory !== 'all') {
            results = results.filter(a => a.category === currentCategory);
        }
        if (currentSearch.trim() !== '') {
            const query = currentSearch.trim().toLowerCase();
            results = results.filter(a =>
                a.title.toLowerCase().includes(query) ||
                a.artist.toLowerCase().includes(query)
            );
        }
        filteredArtworks = results;
        renderGallery();
    }

    // --- RENDER GALLERY GRID ---
    function renderGallery() {
        galleryGrid.innerHTML = '';
        if (filteredArtworks.length === 0) {
            noResults.style.display = 'block';
            return;
        } else {
            noResults.style.display = 'none';
        }
        filteredArtworks.forEach((art, idx) => {
            // Each art card is an <li> with a button for full-screen modal
            const li = document.createElement('li');
            li.setAttribute('role', 'listitem');
            li.className = 'art-card';
            // Main thumbnail button (keyboard and mouse accessible)
            const btn = document.createElement('button');
            btn.type = 'button';
            btn.className = 'art-thumb-btn';
            btn.setAttribute('aria-label', `View details of "${art.title}" by ${art.artist}`);
            btn.setAttribute('tabindex', '0');
            btn.onkeydown = btn.onclick = function(e) {
                if (
                    e.type === 'click' ||
                    (e.type === 'keydown' && (e.key === 'Enter' || e.key === ' '))
                ) {
                    e.preventDefault();
                    openModal(art, btn);
                }
            };
            // Thumbnail image
            const img = document.createElement('img');
            img.src = art.img;
            img.alt = art.alt;
            img.className = 'art-thumb-img';
            img.width = 600;
            img.height = 450;
            btn.appendChild(img);

            // Art info below thumbnail
            const infoDiv = document.createElement('div');
            infoDiv.className = 'art-info';
            // Title
            const title = document.createElement('h3');
            title.className = 'art-title';
            title.textContent = art.title;
            infoDiv.appendChild(title);
            // Artist
            const artist = document.createElement('div');
            artist.className = 'art-artist';
            artist.textContent = art.artist;
            infoDiv.appendChild(artist);
            // Meta (year and category)
            const meta = document.createElement('div');
            meta.className = 'art-meta';
            meta.textContent = `${art.year} • ${categoryLabels[art.category] || art.category}`;
            infoDiv.appendChild(meta);

            // Hover/focus details (visually shown on hover/focus, but not read by screen readers)
            const hoverDetails = document.createElement('div');
            hoverDetails.className = 'hover-details';
            hoverDetails.setAttribute('aria-hidden', 'true');
            hoverDetails.innerHTML = `
                <strong>${art.title}</strong><br>
                <em>${art.artist}</em><br>
                <span>${art.year} • ${categoryLabels[art.category] || art.category}</span><br>
                <span>${art.description}</span>
            `;

            li.appendChild(btn);
            li.appendChild(infoDiv);
            li.appendChild(hoverDetails);

            galleryGrid.appendChild(li);
        });
    }

    // --- MODAL LOGIC ---
    function openModal(art, triggerEl) {
        // Save last focused element to restore focus later
        lastFocusedElement = triggerEl || document.activeElement;
        // Fill modal content
        modalImg.src = art.img;
        modalImg.alt = art.alt;
        modalTitle.textContent = art.title;
        modalArtist.textContent = art.artist;
        modalMeta.textContent = `${art.year} • ${categoryLabels[art.category] || art.category}`;
        modalDesc.textContent = art.description;
        // Show modal
        artModal.style.display = 'flex';
        setTimeout(() => {
            artModal.classList.add('active');
            modalContent.focus();
        }, 10);
        // Trap focus inside modal
        document.addEventListener('keydown', trapModalFocus);
        // Close modal on Escape
        document.addEventListener('keydown', handleModalEscape);
    }

    function closeModal() {
        artModal.classList.remove('active');
        setTimeout(() => {
            artModal.style.display = 'none';
            // Restore focus to last element
            if (lastFocusedElement) lastFocusedElement.focus();
        }, 180);
        document.removeEventListener('keydown', trapModalFocus);
        document.removeEventListener('keydown', handleModalEscape);
    }

    // Trap focus within modal for accessibility
    function trapModalFocus(e) {
        if (!artModal.classList.contains('active')) return;
        const focusable = artModal.querySelectorAll('button, [tabindex]:not([tabindex="-1"])');
        const first = focusable[0];
        const last = focusable[focusable.length - 1];
        if (e.key === 'Tab') {
            if (e.shiftKey) {
                if (document.activeElement === first) {
                    e.preventDefault();
                    last.focus();
                }
            } else {
                if (document.activeElement === last) {
                    e.preventDefault();
                    first.focus();
                }
            }
        }
    }

    // Close modal on Escape key
    function handleModalEscape(e) {
        if (e.key === 'Escape' && artModal.classList.contains('active')) {
            e.preventDefault();
            closeModal();
        }
    }

    // Close modal when clicking outside modal content
    artModal.addEventListener('mousedown', function(e) {
        if (e.target === artModal) {
            closeModal();
        }
    });

    // --- FILTERS EVENT HANDLERS ---
    categorySelect.addEventListener('change', function() {
        currentCategory = this.value;
        filterArtworks();
    });
    searchInput.addEventListener('input', function() {
        currentSearch = this.value;
        filterArtworks();
    });

    // --- DARK MODE ---
    function toggleDarkMode() {
        darkMode = !darkMode;
        document.body.classList.toggle('dark-mode', darkMode);
        darkModeToggle.setAttribute('aria-pressed', darkMode ? 'true' : 'false');
        darkModeIcon.textContent = darkMode ? '☀️' : '🌙';
        darkModeLabel.textContent = darkMode ? 'Light Mode' : 'Dark Mode';
        // Save preference
        if (window.localStorage) {
            localStorage.setItem('artGalleryDarkMode', darkMode ? '1' : '0');
        }
    }
    // Load dark mode preference on page load
    function loadDarkModePref() {
        if (window.localStorage) {
            const pref = localStorage.getItem('artGalleryDarkMode');
            if (pref === '1') {
                darkMode = false; // will be toggled to true
                toggleDarkMode();
            }
        }
    }

    // --- INITIALIZE ---
    function init() {
        loadDarkModePref();
        filterArtworks();
        // Accessibility: Move focus to main content when skip link is used
        document.getElementById('skip-link').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('main-content').focus();
        });
        // Accessibility: Close modal with close button (already handled by handleInteraction)
        modalCloseBtn.addEventListener('click', handleInteraction);
        modalCloseBtn.addEventListener('keydown', handleInteraction);
        // Accessibility: Focus modal content on open
        artModal.addEventListener('transitionend', function() {
            if (artModal.classList.contains('active')) {
                modalContent.focus();
            }
        });
    }

    // --- RUN ---
    window.addEventListener('DOMContentLoaded', init);

    // --- END OF SCRIPT ---
    </script>
    <!-- 
        KEY ACCESSIBILITY FEATURES EXPLAINED:
        - Semantic HTML5 structure (header, nav, main, section, article, footer)
        - All images have descriptive alt text
        - All interactive elements (buttons, inputs) are keyboard accessible and have visible focus indicators
        - Modal traps focus and is accessible to screen readers (role="dialog", aria-modal, labelled/describedby)
        - Filtering/search inputs have associated <label>s
        - No color is used as the only means of conveying information
        - Sufficient color contrast for text and focus indicators
        - Skip link for keyboard users
        - All dynamic content updates are reflected for assistive tech (aria-live on no results)
        - Responsive, mobile-friendly design
    -->
</body>
</html>
